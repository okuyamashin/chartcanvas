# 開発アプローチ

## ファイル構成の方針

### 開発時の構成
開発時は、保守性と可読性を向上させるため、**複数のファイルに分けて開発**します。

```
src/
  ├── main.js          # エントリーポイント
  ├── graph/
  │   ├── line.js      # 折れ線グラフ
  │   ├── bar.js       # 棒グラフ
  │   └── pie.js       # 円グラフ
  ├── data/
  │   ├── parser.js    # データパーサー
  │   └── validator.js # データバリデーション
  ├── svg/
  │   ├── generator.js # SVG生成
  │   └── exporter.js  # SVGエクスポート
  └── utils/
      └── helpers.js   # ユーティリティ関数
```

### 本番環境での構成
本番環境では、**1つのファイルにバンドル**して配布します。

```
dist/
  └── graph-tool.js    # 単一のバンドルファイル（ダウンロード用）
```

## バンドルツールの選定

複数ファイルを1つのファイルに統合するために、以下のいずれかのバンドルツールを使用します：

### 候補1: Rollup
- **特徴**: ライブラリ開発に最適化、ESモジュール対応が良い
- **メリット**: バンドルサイズが小さい、Tree-shakingが優秀
- **デメリット**: 設定がやや複雑

### 候補2: esbuild
- **特徴**: 非常に高速なビルド
- **メリット**: 設定がシンプル、ビルドが速い
- **デメリット**: プラグインエコシステムが小さい

### 候補3: Vite
- **特徴**: 開発サーバーとビルドツール
- **メリット**: 開発体験が良い、Rollupベースでバンドルも優秀
- **デメリット**: フレームワーク向けの機能が多い

### 候補4: Webpack
- **特徴**: 最も広く使われている
- **メリット**: 豊富なプラグイン、柔軟な設定
- **デメリット**: 設定が複雑、ビルドが遅い

## 推奨アプローチ

**Rollup** または **esbuild** を推奨します。
- シンプルなライブラリ開発には最適
- バンドルサイズが小さく、パフォーマンスが良い
- 単一ファイル出力に適している

## 開発フロー

1. **開発フェーズ**
   - 複数ファイルに分けて開発
   - モジュールシステム（ES Modules）を使用
   - 各ファイルは独立してテスト可能

2. **ビルドフェーズ**
   - バンドルツールで1つのファイルに統合
   - 不要なコードの削除（Tree-shaking）
   - ミニファイ（圧縮）処理

3. **配布フェーズ**
   - 単一のJavaScriptファイルとして配布
   - ユーザーは1つのファイルをダウンロードして使用

## モジュールシステム

開発時は **ES Modules (ESM)** を使用します：

```javascript
// main.js
import { createLineGraph } from './graph/line.js';
import { parseCSV } from './data/parser.js';

// graph/line.js
export function createLineGraph(data) {
  // ...
}
```

バンドルツールがこれらを1つのファイルに統合し、ブラウザで動作する形式に変換します。

## メリット

### 複数ファイルで開発するメリット
- ✅ コードの可読性が向上
- ✅ 保守性が向上（変更の影響範囲が明確）
- ✅ チーム開発がしやすい
- ✅ テストが書きやすい
- ✅ 再利用性が高い

### 単一ファイルに統合するメリット
- ✅ ユーザーが簡単に使用できる（1ファイルだけ）
- ✅ 依存関係の管理が不要
- ✅ 配布が簡単
- ✅ ロード時間が短い

