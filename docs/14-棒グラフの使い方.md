# 棒グラフの使い方

## 概要

棒グラフには様々な使い方があります。X軸の種類やデータの性質によって、グラフの意味や表示方法が異なります。

## 棒グラフの主な使い方

### 1. X軸が日付の棒グラフ（時系列データ）

**用途:** 時系列データを表す

**特徴:**
- X軸に日付が並ぶ
- 各日付に対応する値（売上、訪問者数など）を棒で表示
- 折れ線グラフと同様に、日付範囲の指定が必要
- 例: 毎日の売上、毎月の訪問者数

**例:**
```javascript
const barChart = chart.addBarChart();
barChart.setDateRange('2024-01-01', '2024-12-31');
barChart.setData([100, 150, 200, 180, 250, ...]);
```

**注意点:**
- ヒストグラムとは意味が異なる
- 時系列の推移を表すことが目的

### 2. ヒストグラム（分布を表す）

**用途:** データの分布を表す

**特徴:**
- X軸にデータの範囲（ビン）が並ぶ
- 各範囲に含まれるデータの個数（頻度）を棒で表示
- 例: 年齢の分布、テストの点数分布

**例:**
```javascript
// 年齢の分布: 0-10歳、11-20歳、21-30歳、...
const histogram = chart.addHistogram();
histogram.setBins([0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100]);
histogram.setFrequencies([5, 12, 25, 30, 20, 15, 8, 3, 1, 0]);
```

**注意点:**
- X軸が日付の棒グラフとは意味が異なる
- データの分布を表すことが目的
- 各棒の間隔は通常、連続的（間隔がない）

### 3. 構成比を表す棒グラフ（円グラフに近い使い方）

**用途:** 2〜3本の棒で構成比を表す

**特徴:**
- 棒の数が少ない（2本または3本）
- 各棒の値の合計が100%になる（または、パーセンテージで表示）
- 円グラフの代替として使用されることが多い
- **X軸はカテゴリ**（日付ではない）
- 例: 男女比、賛成/反対、A/B/Cの3択の結果

**例:**
```javascript
// 男女比: 男性60%、女性40%
const barChart = chart.addBarChart();
barChart.setXLabels(['男性', '女性']);
barChart.setData([60, 40]);
barChart.setYAxisFormat('percentage'); // Y軸をパーセンテージ表示
```

**注意点:**
- 棒の数が少ないため、円グラフの代替として使われる
- Y軸はパーセンテージ形式で表示されることが多い
- 各棒の値の合計が100%になることが多い
- **X軸はカテゴリであり、日付がX軸の場合はほとんど使われない**
  - 日付がX軸の場合は時系列データを表すことが目的のため、構成比という概念は適さない
  - 技術的には可能だが、実際の使用例はほとんどない

### 4. カテゴリ比較（複数のカテゴリの値を比較）

**用途:** 複数のカテゴリの値を比較する

**特徴:**
- X軸にカテゴリ名が並ぶ（日付ではない）
- 各カテゴリの値を棒で表示
- 例: 商品A、商品B、商品Cの売上比較、都道府県別の人口

**例:**
```javascript
const barChart = chart.addBarChart();
barChart.setXLabels(['商品A', '商品B', '商品C', '商品D']);
barChart.setData([100, 150, 120, 180]);
```

**注意点:**
- X軸は日付ではない
- カテゴリ間の比較が目的

### 5. 積み上げ棒グラフ（複数の系列を積み上げる）

**用途:** 複数の系列を積み上げて表示する

**特徴:**
- 各カテゴリ（または日付）に対して、複数の系列の値を積み上げて表示
- 各系列の合計値と、各系列の内訳の両方が分かる
- 例: 各月の売上を商品別に積み上げ、各月の合計売上と商品別の内訳を表示

**例:**
```javascript
const barChart = chart.addBarChart();
barChart.setXLabels(['1月', '2月', '3月', '4月', '5月']);
barChart.setData([
    [100, 150, 200, 180, 250],  // 商品A
    [50, 80, 100, 120, 150],    // 商品B
    [30, 40, 50, 60, 70]        // 商品C
]);
barChart.setStacked(true);
barChart.setLegendLabels(['商品A', '商品B', '商品C']);
```

**注意点:**
- 複数の系列が必要
- 各系列の合計値と内訳の両方が分かる
- 凡例が必要

### 6. グループ化された棒グラフ（複数の系列を並べて表示）

**用途:** 複数の系列を並べて比較する

**特徴:**
- 各カテゴリ（または日付）に対して、複数の系列の値を並べて表示
- 各系列の値を直接比較できる
- 例: 各月の売上を商品Aと商品Bを並べて表示

**例:**
```javascript
const barChart = chart.addBarChart();
barChart.setXLabels(['1月', '2月', '3月', '4月', '5月']);
barChart.setData([
    [100, 150, 200, 180, 250],  // 商品A
    [80, 120, 180, 160, 220]    // 商品B
]);
barChart.setGrouped(true);
barChart.setLegendLabels(['商品A', '商品B']);
```

**注意点:**
- 複数の系列が必要
- 各系列の値を直接比較できる
- 凡例が必要

### 7. 横向き棒グラフ（Horizontal Bar Chart）

**用途:** カテゴリ名が長い場合や、ソートしてランキング表示する場合

**特徴:**
- **Y軸にカテゴリ**（人、店舗、商品名など）が並ぶ
- **X軸に値**が並ぶ
- 棒が**横に伸びる**（通常の棒グラフは縦に伸びる）
- **ソートをかけて、値の大きい順（または小さい順）に並べることが多い**
- カテゴリ名が長い場合に便利（Y軸に並べることで、ラベルを読みやすく表示できる）
- 例: 店舗別売上ランキング、社員別業績ランキング、商品別売上ランキング

**例:**
```javascript
// 店舗別売上ランキング（値の大きい順にソート）
const barChart = chart.addBarChart();
barChart.setHorizontal(true);  // 横向きモードを有効化
barChart.setYLabels(['新宿店', '渋谷店', '池袋店', '銀座店', '上野店']);
barChart.setData([500, 450, 380, 320, 280]);
barChart.setSort('desc');  // 降順ソート（値の大きい順）
```

**データの作り方:**
- 通常の棒グラフとは**軸が逆**になる
- カテゴリ名をY軸ラベルとして指定
- 値をX軸方向に表示
- ソート機能が重要（値の大きい順/小さい順）

**注意点:**
- 通常の棒グラフとはデータの構造が異なる
- カテゴリ名が長い場合に特に有効
- ランキング表示に適している
- ソート機能が必須

## 使い方の分類

### X軸の種類による分類

1. **X軸が日付**
   - 時系列データ（1. X軸が日付の棒グラフ）
   - 日付範囲の指定が必要
   - **注意:** 構成比を表す棒グラフは、X軸が日付の場合はほとんど使われない

2. **X軸がカテゴリ**
   - カテゴリ比較（4. カテゴリ比較）
   - **構成比を表す棒グラフ（3. 構成比を表す棒グラフ）** - カテゴリがX軸の場合のみ
   - 積み上げ棒グラフ（5. 積み上げ棒グラフ）
   - グループ化された棒グラフ（6. グループ化された棒グラフ）

3. **X軸がデータの範囲（ビン）**
   - ヒストグラム（2. ヒストグラム）

### 棒の数による分類

1. **棒が少ない（2〜3本）**
   - 構成比を表す棒グラフ（3. 構成比を表す棒グラフ）
   - 円グラフの代替として使用されることが多い

2. **棒が中程度（4〜20本程度）**
   - カテゴリ比較（4. カテゴリ比較）
   - グループ化された棒グラフ（6. グループ化された棒グラフ）
   - 横向き棒グラフ（7. 横向き棒グラフ）

3. **棒が多い（20本以上）**
   - X軸が日付の棒グラフ（1. X軸が日付の棒グラフ）
   - ヒストグラム（2. ヒストグラム）

### 向きによる分類

1. **縦向き棒グラフ（通常の棒グラフ）**
   - X軸にカテゴリ、Y軸に値
   - 棒が縦に伸びる
   - 1〜6の使い方

2. **横向き棒グラフ（Horizontal Bar Chart）**
   - Y軸にカテゴリ、X軸に値
   - 棒が横に伸びる
   - 7. 横向き棒グラフ

## 実装上の考慮事項

### 1. X軸が日付の場合

- `setDateRange(startDate, endDate)`メソッドを使用
- 日付範囲に応じて自動的にモードを切り替え（1ヶ月、3ヶ月、1年、1年以上）
- 日付ラベルの階層表示が必要

### 2. ヒストグラムの場合

- 専用の`Histogram`クラスが必要か、`BarChart`クラスで対応するか要検討
- ビン（範囲）の指定方法を検討
- 頻度（個数）のデータを指定

### 3. 構成比を表す棒グラフの場合

- **X軸はカテゴリ**（日付ではない）
- Y軸をパーセンテージ形式で表示
- 棒の数が少ないため、特別な処理は不要かもしれない
- 円グラフの代替として使用されることが多い
- **注意:** X軸が日付の場合はほとんど使われない（時系列データでは構成比という概念が適さない）

### 4. カテゴリ比較の場合

- X軸ラベルにカテゴリ名を指定
- 日付ではないため、`setDateRange()`は使用しない

### 5. 積み上げ棒グラフの場合

- 複数の系列のデータを指定
- `setStacked(true)`で積み上げモードを有効化
- 各系列の色を指定
- 凡例が必要

### 6. グループ化された棒グラフの場合

- 複数の系列のデータを指定
- `setGrouped(true)`でグループ化モードを有効化
- 各系列の色を指定
- 凡例が必要
- 各カテゴリ内で棒を並べて表示（間隔を適切に設定）

### 7. 横向き棒グラフの場合

- `setHorizontal(true)`で横向きモードを有効化
- Y軸ラベルにカテゴリ名を指定（通常のX軸ラベルとは逆）
- X軸に値が表示される（通常のY軸とは逆）
- `setSort('desc')`または`setSort('asc')`でソート（降順/昇順）
- カテゴリ名が長い場合に特に有効
- ランキング表示に適している

## API設計の検討

### 案1: 1つの`BarChart`クラスで全てを対応

```javascript
// X軸が日付の場合
const barChart = chart.addBarChart();
barChart.setDateRange('2024-01-01', '2024-12-31');
barChart.setData([100, 150, 200, ...]);

// カテゴリ比較の場合
const barChart = chart.addBarChart();
barChart.setXLabels(['商品A', '商品B', '商品C']);
barChart.setData([100, 150, 120]);

// ヒストグラムの場合
const barChart = chart.addBarChart();
barChart.setHistogram(true);
barChart.setBins([0, 10, 20, 30, ...]);
barChart.setData([5, 12, 25, ...]);
```

### 案2: 用途別にクラスを分ける

```javascript
// X軸が日付の棒グラフ
const barChart = chart.addBarChart();
barChart.setDateRange('2024-01-01', '2024-12-31');
barChart.setData([100, 150, 200, ...]);

// ヒストグラム
const histogram = chart.addHistogram();
histogram.setBins([0, 10, 20, 30, ...]);
histogram.setData([5, 12, 25, ...]);

// カテゴリ比較
const barChart = chart.addBarChart();
barChart.setXLabels(['商品A', '商品B', '商品C']);
barChart.setData([100, 150, 120]);

// 横向き棒グラフ
const barChart = chart.addBarChart();
barChart.setHorizontal(true);
barChart.setYLabels(['新宿店', '渋谷店', '池袋店', '銀座店', '上野店']);
barChart.setData([500, 450, 380, 320, 280]);
barChart.setSort('desc');
```

**検討が必要:**
- 案1の方がシンプルだが、ヒストグラムは意味が異なるため、案2の方が適切かもしれない
- ただし、実装の複雑さを考慮すると、案1の方が良い可能性もある

## まとめ

棒グラフには以下の7つの主な使い方があります：

1. **X軸が日付の棒グラフ**: 時系列データを表す
2. **ヒストグラム**: データの分布を表す
3. **構成比を表す棒グラフ**: 2〜3本の棒で構成比を表す（円グラフに近い使い方）
4. **カテゴリ比較**: 複数のカテゴリの値を比較する
5. **積み上げ棒グラフ**: 複数の系列を積み上げて表示する
6. **グループ化された棒グラフ**: 複数の系列を並べて比較する
7. **横向き棒グラフ**: Y軸にカテゴリ、X軸に値、ソートしてランキング表示

それぞれの使い方で、X軸の種類、データの形式、表示方法が異なるため、実装時に適切に対応する必要があります。

特に、**横向き棒グラフ**はデータの作り方が通常の棒グラフと異なり（軸が逆）、ソート機能が重要です。

